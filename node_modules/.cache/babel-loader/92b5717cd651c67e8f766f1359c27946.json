{"ast":null,"code":"var Definable = require(\"./Definable\");\n\nvar zrUtil = require(\"../../core/util\");\n\nvar zrLog = require(\"../../core/log\");\n/**\n * @file Manages SVG gradient elements.\n * @author Zhang Wenli\n */\n\n/**\n * Manages SVG gradient elements.\n *\n * @class\n * @extends Definable\n * @param   {number}     zrId    zrender instance id\n * @param   {SVGElement} svgRoot root of SVG document\n */\n\n\nfunction GradientManager(zrId, svgRoot) {\n  Definable.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__');\n}\n\nzrUtil.inherits(GradientManager, Definable);\n/**\n * Create new gradient DOM for fill or stroke if not exist,\n * but will not update gradient if exists.\n *\n * @param {SvgElement}  svgElement   SVG element to paint\n * @param {Displayable} displayable  zrender displayable element\n */\n\nGradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\n  if (displayable && displayable.style) {\n    var that = this;\n    zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\n      if (displayable.style[fillOrStroke] && (displayable.style[fillOrStroke].type === 'linear' || displayable.style[fillOrStroke].type === 'radial')) {\n        var gradient = displayable.style[fillOrStroke];\n        var defs = that.getDefs(true); // Create dom in <defs> if not exists\n\n        var dom;\n\n        if (gradient._dom) {\n          // Gradient exists\n          dom = gradient._dom;\n\n          if (!defs.contains(gradient._dom)) {\n            // _dom is no longer in defs, recreate\n            that.addDom(dom);\n          }\n        } else {\n          // New dom\n          dom = that.add(gradient);\n        }\n\n        that.markUsed(displayable);\n        var id = dom.getAttribute('id');\n        svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n      }\n    });\n  }\n};\n/**\n * Add a new gradient tag in <defs>\n *\n * @param   {Gradient} gradient zr gradient instance\n * @return {SVGLinearGradientElement | SVGRadialGradientElement}\n *                            created DOM\n */\n\n\nGradientManager.prototype.add = function (gradient) {\n  var dom;\n\n  if (gradient.type === 'linear') {\n    dom = this.createElement('linearGradient');\n  } else if (gradient.type === 'radial') {\n    dom = this.createElement('radialGradient');\n  } else {\n    zrLog('Illegal gradient type.');\n    return null;\n  } // Set dom id with gradient id, since each gradient instance\n  // will have no more than one dom element.\n  // id may exists before for those dirty elements, in which case\n  // id should remain the same, and other attributes should be\n  // updated.\n\n\n  gradient.id = gradient.id || this.nextId++;\n  dom.setAttribute('id', 'zr' + this._zrId + '-gradient-' + gradient.id);\n  this.updateDom(gradient, dom);\n  this.addDom(dom);\n  return dom;\n};\n/**\n * Update gradient.\n *\n * @param {Gradient} gradient zr gradient instance\n */\n\n\nGradientManager.prototype.update = function (gradient) {\n  var that = this;\n  Definable.prototype.update.call(this, gradient, function () {\n    var type = gradient.type;\n    var tagName = gradient._dom.tagName;\n\n    if (type === 'linear' && tagName === 'linearGradient' || type === 'radial' && tagName === 'radialGradient') {\n      // Gradient type is not changed, update gradient\n      that.updateDom(gradient, gradient._dom);\n    } else {\n      // Remove and re-create if type is changed\n      that.removeDom(gradient);\n      that.add(gradient);\n    }\n  });\n};\n/**\n * Update gradient dom\n *\n * @param {Gradient} gradient zr gradient instance\n * @param {SVGLinearGradientElement | SVGRadialGradientElement} dom\n *                            DOM to update\n */\n\n\nGradientManager.prototype.updateDom = function (gradient, dom) {\n  if (gradient.type === 'linear') {\n    dom.setAttribute('x1', gradient.x);\n    dom.setAttribute('y1', gradient.y);\n    dom.setAttribute('x2', gradient.x2);\n    dom.setAttribute('y2', gradient.y2);\n  } else if (gradient.type === 'radial') {\n    dom.setAttribute('cx', gradient.x);\n    dom.setAttribute('cy', gradient.y);\n    dom.setAttribute('r', gradient.r);\n  } else {\n    zrLog('Illegal gradient type.');\n    return;\n  }\n\n  if (gradient.global) {\n    // x1, x2, y1, y2 in range of 0 to canvas width or height\n    dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n  } else {\n    // x1, x2, y1, y2 in range of 0 to 1\n    dom.setAttribute('gradientUnits', 'objectBoundingBox');\n  } // Remove color stops if exists\n\n\n  dom.innerHTML = ''; // Add color stops\n\n  var colors = gradient.colorStops;\n\n  for (var i = 0, len = colors.length; i < len; ++i) {\n    var stop = this.createElement('stop');\n    stop.setAttribute('offset', colors[i].offset * 100 + '%');\n    stop.setAttribute('stop-color', colors[i].color);\n    dom.appendChild(stop);\n  } // Store dom element in gradient, to avoid creating multiple\n  // dom instances for the same gradient element\n\n\n  gradient._dom = dom;\n};\n/**\n * Mark a single gradient to be used\n *\n * @param {Displayable} displayable displayable element\n */\n\n\nGradientManager.prototype.markUsed = function (displayable) {\n  if (displayable.style) {\n    var gradient = displayable.style.fill;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n\n    gradient = displayable.style.stroke;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n  }\n};\n\nvar _default = GradientManager;\nmodule.exports = _default;","map":{"version":3,"names":["Definable","require","zrUtil","zrLog","GradientManager","zrId","svgRoot","call","inherits","prototype","addWithoutUpdate","svgElement","displayable","style","that","each","fillOrStroke","type","gradient","defs","getDefs","dom","_dom","contains","addDom","add","markUsed","id","getAttribute","setAttribute","createElement","nextId","_zrId","updateDom","update","tagName","removeDom","x","y","x2","y2","r","global","innerHTML","colors","colorStops","i","len","length","stop","offset","color","appendChild","fill","stroke","_default","module","exports"],"sources":["C:/Users/W/Desktop/vue_map/node_modules/zrender/lib/svg/helper/GradientManager.js"],"sourcesContent":["var Definable = require(\"./Definable\");\n\nvar zrUtil = require(\"../../core/util\");\n\nvar zrLog = require(\"../../core/log\");\n\n/**\n * @file Manages SVG gradient elements.\n * @author Zhang Wenli\n */\n\n/**\n * Manages SVG gradient elements.\n *\n * @class\n * @extends Definable\n * @param   {number}     zrId    zrender instance id\n * @param   {SVGElement} svgRoot root of SVG document\n */\nfunction GradientManager(zrId, svgRoot) {\n  Definable.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__');\n}\n\nzrUtil.inherits(GradientManager, Definable);\n/**\n * Create new gradient DOM for fill or stroke if not exist,\n * but will not update gradient if exists.\n *\n * @param {SvgElement}  svgElement   SVG element to paint\n * @param {Displayable} displayable  zrender displayable element\n */\n\nGradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\n  if (displayable && displayable.style) {\n    var that = this;\n    zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\n      if (displayable.style[fillOrStroke] && (displayable.style[fillOrStroke].type === 'linear' || displayable.style[fillOrStroke].type === 'radial')) {\n        var gradient = displayable.style[fillOrStroke];\n        var defs = that.getDefs(true); // Create dom in <defs> if not exists\n\n        var dom;\n\n        if (gradient._dom) {\n          // Gradient exists\n          dom = gradient._dom;\n\n          if (!defs.contains(gradient._dom)) {\n            // _dom is no longer in defs, recreate\n            that.addDom(dom);\n          }\n        } else {\n          // New dom\n          dom = that.add(gradient);\n        }\n\n        that.markUsed(displayable);\n        var id = dom.getAttribute('id');\n        svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n      }\n    });\n  }\n};\n/**\n * Add a new gradient tag in <defs>\n *\n * @param   {Gradient} gradient zr gradient instance\n * @return {SVGLinearGradientElement | SVGRadialGradientElement}\n *                            created DOM\n */\n\n\nGradientManager.prototype.add = function (gradient) {\n  var dom;\n\n  if (gradient.type === 'linear') {\n    dom = this.createElement('linearGradient');\n  } else if (gradient.type === 'radial') {\n    dom = this.createElement('radialGradient');\n  } else {\n    zrLog('Illegal gradient type.');\n    return null;\n  } // Set dom id with gradient id, since each gradient instance\n  // will have no more than one dom element.\n  // id may exists before for those dirty elements, in which case\n  // id should remain the same, and other attributes should be\n  // updated.\n\n\n  gradient.id = gradient.id || this.nextId++;\n  dom.setAttribute('id', 'zr' + this._zrId + '-gradient-' + gradient.id);\n  this.updateDom(gradient, dom);\n  this.addDom(dom);\n  return dom;\n};\n/**\n * Update gradient.\n *\n * @param {Gradient} gradient zr gradient instance\n */\n\n\nGradientManager.prototype.update = function (gradient) {\n  var that = this;\n  Definable.prototype.update.call(this, gradient, function () {\n    var type = gradient.type;\n    var tagName = gradient._dom.tagName;\n\n    if (type === 'linear' && tagName === 'linearGradient' || type === 'radial' && tagName === 'radialGradient') {\n      // Gradient type is not changed, update gradient\n      that.updateDom(gradient, gradient._dom);\n    } else {\n      // Remove and re-create if type is changed\n      that.removeDom(gradient);\n      that.add(gradient);\n    }\n  });\n};\n/**\n * Update gradient dom\n *\n * @param {Gradient} gradient zr gradient instance\n * @param {SVGLinearGradientElement | SVGRadialGradientElement} dom\n *                            DOM to update\n */\n\n\nGradientManager.prototype.updateDom = function (gradient, dom) {\n  if (gradient.type === 'linear') {\n    dom.setAttribute('x1', gradient.x);\n    dom.setAttribute('y1', gradient.y);\n    dom.setAttribute('x2', gradient.x2);\n    dom.setAttribute('y2', gradient.y2);\n  } else if (gradient.type === 'radial') {\n    dom.setAttribute('cx', gradient.x);\n    dom.setAttribute('cy', gradient.y);\n    dom.setAttribute('r', gradient.r);\n  } else {\n    zrLog('Illegal gradient type.');\n    return;\n  }\n\n  if (gradient.global) {\n    // x1, x2, y1, y2 in range of 0 to canvas width or height\n    dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n  } else {\n    // x1, x2, y1, y2 in range of 0 to 1\n    dom.setAttribute('gradientUnits', 'objectBoundingBox');\n  } // Remove color stops if exists\n\n\n  dom.innerHTML = ''; // Add color stops\n\n  var colors = gradient.colorStops;\n\n  for (var i = 0, len = colors.length; i < len; ++i) {\n    var stop = this.createElement('stop');\n    stop.setAttribute('offset', colors[i].offset * 100 + '%');\n    stop.setAttribute('stop-color', colors[i].color);\n    dom.appendChild(stop);\n  } // Store dom element in gradient, to avoid creating multiple\n  // dom instances for the same gradient element\n\n\n  gradient._dom = dom;\n};\n/**\n * Mark a single gradient to be used\n *\n * @param {Displayable} displayable displayable element\n */\n\n\nGradientManager.prototype.markUsed = function (displayable) {\n  if (displayable.style) {\n    var gradient = displayable.style.fill;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n\n    gradient = displayable.style.stroke;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n  }\n};\n\nvar _default = GradientManager;\nmodule.exports = _default;"],"mappings":"AAAA,IAAIA,SAAS,GAAGC,OAAO,CAAC,aAAD,CAAvB;;AAEA,IAAIC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAApB;;AAEA,IAAIE,KAAK,GAAGF,OAAO,CAAC,gBAAD,CAAnB;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASG,eAAT,CAAyBC,IAAzB,EAA+BC,OAA/B,EAAwC;EACtCN,SAAS,CAACO,IAAV,CAAe,IAAf,EAAqBF,IAArB,EAA2BC,OAA3B,EAAoC,CAAC,gBAAD,EAAmB,gBAAnB,CAApC,EAA0E,qBAA1E;AACD;;AAEDJ,MAAM,CAACM,QAAP,CAAgBJ,eAAhB,EAAiCJ,SAAjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAI,eAAe,CAACK,SAAhB,CAA0BC,gBAA1B,GAA6C,UAAUC,UAAV,EAAsBC,WAAtB,EAAmC;EAC9E,IAAIA,WAAW,IAAIA,WAAW,CAACC,KAA/B,EAAsC;IACpC,IAAIC,IAAI,GAAG,IAAX;IACAZ,MAAM,CAACa,IAAP,CAAY,CAAC,MAAD,EAAS,QAAT,CAAZ,EAAgC,UAAUC,YAAV,EAAwB;MACtD,IAAIJ,WAAW,CAACC,KAAZ,CAAkBG,YAAlB,MAAoCJ,WAAW,CAACC,KAAZ,CAAkBG,YAAlB,EAAgCC,IAAhC,KAAyC,QAAzC,IAAqDL,WAAW,CAACC,KAAZ,CAAkBG,YAAlB,EAAgCC,IAAhC,KAAyC,QAAlI,CAAJ,EAAiJ;QAC/I,IAAIC,QAAQ,GAAGN,WAAW,CAACC,KAAZ,CAAkBG,YAAlB,CAAf;QACA,IAAIG,IAAI,GAAGL,IAAI,CAACM,OAAL,CAAa,IAAb,CAAX,CAF+I,CAEhH;;QAE/B,IAAIC,GAAJ;;QAEA,IAAIH,QAAQ,CAACI,IAAb,EAAmB;UACjB;UACAD,GAAG,GAAGH,QAAQ,CAACI,IAAf;;UAEA,IAAI,CAACH,IAAI,CAACI,QAAL,CAAcL,QAAQ,CAACI,IAAvB,CAAL,EAAmC;YACjC;YACAR,IAAI,CAACU,MAAL,CAAYH,GAAZ;UACD;QACF,CARD,MAQO;UACL;UACAA,GAAG,GAAGP,IAAI,CAACW,GAAL,CAASP,QAAT,CAAN;QACD;;QAEDJ,IAAI,CAACY,QAAL,CAAcd,WAAd;QACA,IAAIe,EAAE,GAAGN,GAAG,CAACO,YAAJ,CAAiB,IAAjB,CAAT;QACAjB,UAAU,CAACkB,YAAX,CAAwBb,YAAxB,EAAsC,UAAUW,EAAV,GAAe,GAArD;MACD;IACF,CAxBD;EAyBD;AACF,CA7BD;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGAvB,eAAe,CAACK,SAAhB,CAA0BgB,GAA1B,GAAgC,UAAUP,QAAV,EAAoB;EAClD,IAAIG,GAAJ;;EAEA,IAAIH,QAAQ,CAACD,IAAT,KAAkB,QAAtB,EAAgC;IAC9BI,GAAG,GAAG,KAAKS,aAAL,CAAmB,gBAAnB,CAAN;EACD,CAFD,MAEO,IAAIZ,QAAQ,CAACD,IAAT,KAAkB,QAAtB,EAAgC;IACrCI,GAAG,GAAG,KAAKS,aAAL,CAAmB,gBAAnB,CAAN;EACD,CAFM,MAEA;IACL3B,KAAK,CAAC,wBAAD,CAAL;IACA,OAAO,IAAP;EACD,CAViD,CAUhD;EACF;EACA;EACA;EACA;;;EAGAe,QAAQ,CAACS,EAAT,GAAcT,QAAQ,CAACS,EAAT,IAAe,KAAKI,MAAL,EAA7B;EACAV,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuB,OAAO,KAAKG,KAAZ,GAAoB,YAApB,GAAmCd,QAAQ,CAACS,EAAnE;EACA,KAAKM,SAAL,CAAef,QAAf,EAAyBG,GAAzB;EACA,KAAKG,MAAL,CAAYH,GAAZ;EACA,OAAOA,GAAP;AACD,CAtBD;AAuBA;AACA;AACA;AACA;AACA;;;AAGAjB,eAAe,CAACK,SAAhB,CAA0ByB,MAA1B,GAAmC,UAAUhB,QAAV,EAAoB;EACrD,IAAIJ,IAAI,GAAG,IAAX;EACAd,SAAS,CAACS,SAAV,CAAoByB,MAApB,CAA2B3B,IAA3B,CAAgC,IAAhC,EAAsCW,QAAtC,EAAgD,YAAY;IAC1D,IAAID,IAAI,GAAGC,QAAQ,CAACD,IAApB;IACA,IAAIkB,OAAO,GAAGjB,QAAQ,CAACI,IAAT,CAAca,OAA5B;;IAEA,IAAIlB,IAAI,KAAK,QAAT,IAAqBkB,OAAO,KAAK,gBAAjC,IAAqDlB,IAAI,KAAK,QAAT,IAAqBkB,OAAO,KAAK,gBAA1F,EAA4G;MAC1G;MACArB,IAAI,CAACmB,SAAL,CAAef,QAAf,EAAyBA,QAAQ,CAACI,IAAlC;IACD,CAHD,MAGO;MACL;MACAR,IAAI,CAACsB,SAAL,CAAelB,QAAf;MACAJ,IAAI,CAACW,GAAL,CAASP,QAAT;IACD;EACF,CAZD;AAaD,CAfD;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGAd,eAAe,CAACK,SAAhB,CAA0BwB,SAA1B,GAAsC,UAAUf,QAAV,EAAoBG,GAApB,EAAyB;EAC7D,IAAIH,QAAQ,CAACD,IAAT,KAAkB,QAAtB,EAAgC;IAC9BI,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACmB,CAAhC;IACAhB,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACoB,CAAhC;IACAjB,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACqB,EAAhC;IACAlB,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACsB,EAAhC;EACD,CALD,MAKO,IAAItB,QAAQ,CAACD,IAAT,KAAkB,QAAtB,EAAgC;IACrCI,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACmB,CAAhC;IACAhB,GAAG,CAACQ,YAAJ,CAAiB,IAAjB,EAAuBX,QAAQ,CAACoB,CAAhC;IACAjB,GAAG,CAACQ,YAAJ,CAAiB,GAAjB,EAAsBX,QAAQ,CAACuB,CAA/B;EACD,CAJM,MAIA;IACLtC,KAAK,CAAC,wBAAD,CAAL;IACA;EACD;;EAED,IAAIe,QAAQ,CAACwB,MAAb,EAAqB;IACnB;IACArB,GAAG,CAACQ,YAAJ,CAAiB,eAAjB,EAAkC,gBAAlC;EACD,CAHD,MAGO;IACL;IACAR,GAAG,CAACQ,YAAJ,CAAiB,eAAjB,EAAkC,mBAAlC;EACD,CArB4D,CAqB3D;;;EAGFR,GAAG,CAACsB,SAAJ,GAAgB,EAAhB,CAxB6D,CAwBzC;;EAEpB,IAAIC,MAAM,GAAG1B,QAAQ,CAAC2B,UAAtB;;EAEA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGH,MAAM,CAACI,MAA7B,EAAqCF,CAAC,GAAGC,GAAzC,EAA8C,EAAED,CAAhD,EAAmD;IACjD,IAAIG,IAAI,GAAG,KAAKnB,aAAL,CAAmB,MAAnB,CAAX;IACAmB,IAAI,CAACpB,YAAL,CAAkB,QAAlB,EAA4Be,MAAM,CAACE,CAAD,CAAN,CAAUI,MAAV,GAAmB,GAAnB,GAAyB,GAArD;IACAD,IAAI,CAACpB,YAAL,CAAkB,YAAlB,EAAgCe,MAAM,CAACE,CAAD,CAAN,CAAUK,KAA1C;IACA9B,GAAG,CAAC+B,WAAJ,CAAgBH,IAAhB;EACD,CAjC4D,CAiC3D;EACF;;;EAGA/B,QAAQ,CAACI,IAAT,GAAgBD,GAAhB;AACD,CAtCD;AAuCA;AACA;AACA;AACA;AACA;;;AAGAjB,eAAe,CAACK,SAAhB,CAA0BiB,QAA1B,GAAqC,UAAUd,WAAV,EAAuB;EAC1D,IAAIA,WAAW,CAACC,KAAhB,EAAuB;IACrB,IAAIK,QAAQ,GAAGN,WAAW,CAACC,KAAZ,CAAkBwC,IAAjC;;IAEA,IAAInC,QAAQ,IAAIA,QAAQ,CAACI,IAAzB,EAA+B;MAC7BtB,SAAS,CAACS,SAAV,CAAoBiB,QAApB,CAA6BnB,IAA7B,CAAkC,IAAlC,EAAwCW,QAAQ,CAACI,IAAjD;IACD;;IAEDJ,QAAQ,GAAGN,WAAW,CAACC,KAAZ,CAAkByC,MAA7B;;IAEA,IAAIpC,QAAQ,IAAIA,QAAQ,CAACI,IAAzB,EAA+B;MAC7BtB,SAAS,CAACS,SAAV,CAAoBiB,QAApB,CAA6BnB,IAA7B,CAAkC,IAAlC,EAAwCW,QAAQ,CAACI,IAAjD;IACD;EACF;AACF,CAdD;;AAgBA,IAAIiC,QAAQ,GAAGnD,eAAf;AACAoD,MAAM,CAACC,OAAP,GAAiBF,QAAjB"},"metadata":{},"sourceType":"script"}