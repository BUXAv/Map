{"ast":null,"code":"var echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar TooltipContent = require(\"./TooltipContent\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar findPointFromSeries = require(\"../axisPointer/findPointFromSeries\");\n\nvar layoutUtil = require(\"../../util/layout\");\n\nvar Model = require(\"../../model/Model\");\n\nvar globalListener = require(\"../axisPointer/globalListener\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar axisPointerViewHelper = require(\"../axisPointer/viewHelper\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\nvar bind = zrUtil.bind;\nvar each = zrUtil.each;\nvar parsePercent = numberUtil.parsePercent;\nvar proxyRect = new graphic.Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\n\nvar _default = echarts.extendComponentView({\n  type: 'tooltip',\n  init: function (ecModel, api) {\n    if (env.node) {\n      return;\n    }\n\n    var tooltipContent = new TooltipContent(api.getDom(), api);\n    this._tooltipContent = tooltipContent;\n  },\n  render: function (tooltipModel, ecModel, api) {\n    if (env.node || env.wxa) {\n      return;\n    } // Reset\n\n\n    this.group.removeAll();\n    /**\n     * @private\n     * @type {module:echarts/component/tooltip/TooltipModel}\n     */\n\n    this._tooltipModel = tooltipModel;\n    /**\n     * @private\n     * @type {module:echarts/model/Global}\n     */\n\n    this._ecModel = ecModel;\n    /**\n     * @private\n     * @type {module:echarts/ExtensionAPI}\n     */\n\n    this._api = api;\n    /**\n     * Should be cleaned when render.\n     * @private\n     * @type {Array.<Array.<Object>>}\n     */\n\n    this._lastDataByCoordSys = null;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update();\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  },\n  _initGlobalListener: function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    globalListener.register('itemTooltip', this._api, bind(function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  },\n  _keepShow: function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api; // Try to keep the tooltip show when refreshing\n\n    if (this._lastX != null && this._lastY != null // When user is willing to control tooltip totally using API,\n    // self.manuallyShowTip({x, y}) might cause tooltip hide,\n    // which is not expected.\n    && tooltipModel.get('triggerOn') !== 'none') {\n      var self = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        // Show tip next tick after other charts are rendered\n        // In case highlight action has wrong result\n        // FIXME\n        self.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self._lastX,\n          y: self._lastY\n        });\n      });\n    }\n  },\n\n  /**\n   * Show tip manually by\n   * dispatchAction({\n   *     type: 'showTip',\n   *     x: 10,\n   *     y: 10\n   * });\n   * Or\n   * dispatchAction({\n   *      type: 'showTip',\n   *      seriesIndex: 0,\n   *      dataIndex or dataIndexInside or name\n   * });\n   *\n   *  TODO Batch\n   */\n  manuallyShowTip: function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env.node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction(payload, api); // Reset ticket\n\n    this._ticket = ''; // When triggered from axisPointer.\n\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.position = [payload.x, payload.y];\n      el.update();\n      el.tooltip = payload.tooltip; // Manually show tooltip while view is not using zrender elements.\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        event: {},\n        dataByCoordSys: payload.dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries(payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el,\n          event: {}\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      // FIXME\n      // should wrap dispatchAction like `axisPointer/globalListener` ?\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target,\n        event: {}\n      }, dispatchAction);\n    }\n  },\n  manuallyHideTip: function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction(payload, api));\n    }\n  },\n  // Be compatible with previous design, that is, when tooltip.type is 'axis' and\n  // dispatchAction 'showTip' with seriesIndex and dataIndex will trigger axis pointer\n  // and tooltip.\n  _manuallyAxisShowTip: function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  },\n  _tryShow: function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    } // Save mouse x, mouse y. So we can try to keep showing the tip if chart is refreshed\n\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } // Always show item tooltip if mouse is on the element with dataIndex\n    else if (el && el.dataIndex != null) {\n      this._lastDataByCoordSys = null;\n\n      this._showSeriesItemTooltip(e, el, dispatchAction);\n    } // Tooltip provided directly. Like legend.\n    else if (el && el.tooltip) {\n      this._lastDataByCoordSys = null;\n\n      this._showComponentItemTooltip(e, el, dispatchAction);\n    } else {\n      this._lastDataByCoordSys = null;\n\n      this._hide(dispatchAction);\n    }\n  },\n  _showOrMove: function (tooltipModel, cb) {\n    // showDelay is used in this case: tooltip.enterable is set\n    // as true. User intent to move mouse into tooltip and click\n    // something. `showDelay` makes it easyer to enter the content\n    // but tooltip do not move immediately.\n    var delay = tooltipModel.get('showDelay');\n    cb = zrUtil.bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  },\n  _showAxisTooltip: function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleDefaultHTML = [];\n    var singleParamsList = [];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    each(dataByCoordSys, function (itemCoordSys) {\n      // var coordParamList = [];\n      // var coordDefaultHTML = [];\n      // var coordTooltipModel = buildTooltipModel([\n      //     e.tooltipOption,\n      //     itemCoordSys.tooltipOption,\n      //     ecModel.getComponent(itemCoordSys.coordSysMainType, itemCoordSys.coordSysIndex),\n      //     globalTooltipModel\n      // ]);\n      // var displayMode = coordTooltipModel.get('displayMode');\n      // var paramsList = displayMode === 'single' ? singleParamsList : [];\n      each(itemCoordSys.dataByAxis, function (item) {\n        var axisModel = ecModel.getComponent(item.axisDim + 'Axis', item.axisIndex);\n        var axisValue = item.value;\n        var seriesDefaultHTML = [];\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var valueLabel = axisPointerViewHelper.getValueLabel(axisValue, axisModel.axis, ecModel, item.seriesDataIndices, item.valueLabelOpt);\n        zrUtil.each(item.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var dataParams = series && series.getDataParams(dataIndex);\n          dataParams.axisDim = item.axisDim;\n          dataParams.axisIndex = item.axisIndex;\n          dataParams.axisType = item.axisType;\n          dataParams.axisId = item.axisId;\n          dataParams.axisValue = axisHelper.getAxisRawValue(axisModel.axis, axisValue);\n          dataParams.axisValueLabel = valueLabel;\n\n          if (dataParams) {\n            singleParamsList.push(dataParams);\n            seriesDefaultHTML.push(series.formatTooltip(dataIndex, true));\n          }\n        }); // Default tooltip content\n        // FIXME\n        // (1) shold be the first data which has name?\n        // (2) themeRiver, firstDataIndex is array, and first line is unnecessary.\n\n        var firstLine = valueLabel;\n        singleDefaultHTML.push((firstLine ? formatUtil.encodeHTML(firstLine) + '<br />' : '') + seriesDefaultHTML.join('<br />'));\n      });\n    }, this); // In most case, the second axis is shown upper than the first one.\n\n    singleDefaultHTML.reverse();\n    singleDefaultHTML = singleDefaultHTML.join('<br /><br />');\n    var positionExpr = e.position;\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, singleParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, singleDefaultHTML, singleParamsList, Math.random(), point[0], point[1], positionExpr);\n      }\n    }); // Do not trigger events here, because this branch only be entered\n    // from dispatchAction.\n\n  },\n  _showSeriesItemTooltip: function (e, el, dispatchAction) {\n    var ecModel = this._ecModel; // Use dataModel in element if possible\n    // Used when mouseover on a element like markPoint or edge\n    // In which case, the data is not main data in series.\n\n    var seriesIndex = el.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex); // For example, graph link.\n\n    var dataModel = el.dataModel || seriesModel;\n    var dataIndex = el.dataIndex;\n    var dataType = el.dataType;\n    var data = dataModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var defaultHtml = dataModel.formatTooltip(dataIndex, false, dataType);\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, defaultHtml, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target);\n    }); // FIXME\n    // duplicated showtip if manuallyShowTip is called from dispatchAction.\n\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  },\n  _showComponentItemTooltip: function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (typeof tooltipOpt === 'string') {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        // Fixed formatter\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model(tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random(); // Do not check whether `trigger` is 'none' here, because `trigger`\n    // only works on cooridinate system. In fact, we have not found case\n    // that requires setting `trigger` nothing on component yet.\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el);\n    }); // If not dispatch showTip, tip may be hide triggered by axis.\n\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  },\n  _showTooltipContent: function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el) {\n    // Reset ticket\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    if (formatter && typeof formatter === 'string') {\n      html = formatUtil.formatTpl(formatter, params, true);\n    } else if (typeof formatter === 'function') {\n      var callback = bind(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html);\n    tooltipContent.show(tooltipModel);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  },\n\n  /**\n   * @param  {string|Function|Array.<number>|Object} positionExpr\n   * @param  {number} x Mouse x\n   * @param  {number} y Mouse y\n   * @param  {boolean} confine Whether confine tooltip content in view rect.\n   * @param  {Object|<Array.<Object>} params\n   * @param  {module:zrender/Element} el target element\n   * @param  {module:echarts/ExtensionAPI} api\n   * @return {Array.<number>}\n   */\n  _updatePosition: function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (typeof positionExpr === 'function') {\n      // Callback of position can be an array or a string specify the position\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (zrUtil.isArray(positionExpr)) {\n      x = parsePercent(positionExpr[0], viewWidth);\n      y = parsePercent(positionExpr[1], viewHeight);\n    } else if (zrUtil.isObject(positionExpr)) {\n      positionExpr.width = contentSize[0];\n      positionExpr.height = contentSize[1];\n      var layoutRect = layoutUtil.getLayoutRect(positionExpr, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null; // When positionExpr is left/top/right/bottom,\n      // align and verticalAlign will not work.\n\n      vAlign = null;\n    } // Specify tooltip position by string 'top' 'bottom' 'left' 'right' around graphic element\n    else if (typeof positionExpr === 'string' && el) {\n      var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n      x = pos[0];\n      y = pos[1];\n    } else {\n      var pos = refixTooltipPosition(x, y, content.el, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (tooltipModel.get('confine')) {\n      var pos = confineTooltipPosition(x, y, content.el, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  },\n  // FIXME\n  // Should we remove this but leave this to user?\n  _updateContentNotChangedOnAxis: function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || {};\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged &= lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged &= lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged &= lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  },\n  _hide: function (dispatchAction) {\n    // Do not directly hideLater here, because this behavior may be prevented\n    // in dispatchAction when showTip is dispatched.\n    // FIXME\n    // duplicated hideTip if manuallyHideTip is called from dispatchAction.\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  },\n  dispose: function (ecModel, api) {\n    if (env.node || env.wxa) {\n      return;\n    }\n\n    this._tooltipContent.hide();\n\n    globalListener.unregister('itemTooltip', api);\n  }\n});\n/**\n * @param {Array.<Object|module:echarts/model/Model>} modelCascade\n * From top to bottom. (the last one should be globalTooltipModel);\n */\n\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (Model.isInstance(tooltipOpt)) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      } // In each data item tooltip can be simply write:\n      // {\n      //  value: 10,\n      //  tooltip: 'Something you need to know'\n      // }\n\n\n      if (typeof tooltipOpt === 'string') {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model(tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction(payload, api) {\n  return payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, el, viewWidth, viewHeight, gapH, gapV) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, el, viewWidth, viewHeight) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction getOuterSize(el) {\n  var width = el.clientWidth;\n  var height = el.clientHeight; // Consider browser compatibility.\n  // IE8 does not support getComputedStyle.\n\n  if (document.defaultView && document.defaultView.getComputedStyle) {\n    var stl = document.defaultView.getComputedStyle(el);\n\n    if (stl) {\n      width += parseInt(stl.paddingLeft, 10) + parseInt(stl.paddingRight, 10) + parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n      height += parseInt(stl.paddingTop, 10) + parseInt(stl.paddingBottom, 10) + parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n    }\n  }\n\n  return {\n    width: width,\n    height: height\n  };\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\nmodule.exports = _default;","map":{"version":3,"names":["echarts","require","zrUtil","env","TooltipContent","formatUtil","numberUtil","graphic","findPointFromSeries","layoutUtil","Model","globalListener","axisHelper","axisPointerViewHelper","bind","each","parsePercent","proxyRect","Rect","shape","x","y","width","height","_default","extendComponentView","type","init","ecModel","api","node","tooltipContent","getDom","_tooltipContent","render","tooltipModel","wxa","group","removeAll","_tooltipModel","_ecModel","_api","_lastDataByCoordSys","_alwaysShowContent","get","update","setEnterable","_initGlobalListener","_keepShow","triggerOn","register","currTrigger","e","dispatchAction","indexOf","_tryShow","_hide","_lastX","_lastY","self","clearTimeout","_refreshUpdateTimeout","setTimeout","manuallyShowTip","payload","from","uid","makeDispatchAction","_ticket","dataByCoordSys","tooltip","el","position","offsetX","offsetY","target","event","tooltipOption","seriesIndex","_manuallyAxisShowTip","pointInfo","cx","point","cy","getZr","findHover","manuallyHideTip","hideLater","dataIndex","coordSysAxesInfo","getComponent","seriesModel","getSeriesByIndex","data","getData","buildTooltipModel","getItemModel","coordinateSystem","model","length","_showAxisTooltip","_showSeriesItemTooltip","_showComponentItemTooltip","_showOrMove","cb","delay","_showTimout","globalTooltipModel","singleDefaultHTML","singleParamsList","singleTooltipModel","itemCoordSys","dataByAxis","item","axisModel","axisDim","axisIndex","axisValue","value","seriesDefaultHTML","valueLabel","getValueLabel","axis","seriesDataIndices","valueLabelOpt","idxItem","series","dataIndexInside","dataParams","getDataParams","axisType","axisId","getAxisRawValue","axisValueLabel","push","formatTooltip","firstLine","encodeHTML","join","reverse","positionExpr","_updateContentNotChangedOnAxis","_updatePosition","_showTooltipContent","Math","random","dataModel","dataType","tooltipTrigger","params","defaultHtml","asyncTicket","name","getRawIndex","tooltipOpt","content","formatter","subTooltipModel","html","formatTpl","callback","cbTicket","setContent","show","viewWidth","getWidth","viewHeight","getHeight","contentSize","getSize","align","vAlign","rect","getBoundingRect","clone","applyTransform","transform","viewSize","slice","isArray","isObject","layoutRect","getLayoutRect","pos","calcTooltipPosition","refixTooltipPosition","isCenterAlign","confineTooltipPosition","moveTo","lastCoordSys","contentNotChanged","lastItemCoordSys","indexCoordSys","lastDataByAxis","thisItemCoordSys","thisDataByAxis","lastItem","indexAxis","thisItem","lastIndices","newIndices","lastIdxItem","j","newIdxItem","dispose","hide","unregister","modelCascade","resultModel","pop","isInstance","gapH","gapV","size","getOuterSize","min","max","clientWidth","clientHeight","document","defaultView","getComputedStyle","stl","parseInt","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","domWidth","domHeight","gap","rectWidth","rectHeight","module","exports"],"sources":["C:/Users/W/Desktop/vue_map/node_modules/echarts/lib/component/tooltip/TooltipView.js"],"sourcesContent":["var echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar TooltipContent = require(\"./TooltipContent\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar findPointFromSeries = require(\"../axisPointer/findPointFromSeries\");\n\nvar layoutUtil = require(\"../../util/layout\");\n\nvar Model = require(\"../../model/Model\");\n\nvar globalListener = require(\"../axisPointer/globalListener\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar axisPointerViewHelper = require(\"../axisPointer/viewHelper\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar bind = zrUtil.bind;\nvar each = zrUtil.each;\nvar parsePercent = numberUtil.parsePercent;\nvar proxyRect = new graphic.Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\n\nvar _default = echarts.extendComponentView({\n  type: 'tooltip',\n  init: function (ecModel, api) {\n    if (env.node) {\n      return;\n    }\n\n    var tooltipContent = new TooltipContent(api.getDom(), api);\n    this._tooltipContent = tooltipContent;\n  },\n  render: function (tooltipModel, ecModel, api) {\n    if (env.node || env.wxa) {\n      return;\n    } // Reset\n\n\n    this.group.removeAll();\n    /**\n     * @private\n     * @type {module:echarts/component/tooltip/TooltipModel}\n     */\n\n    this._tooltipModel = tooltipModel;\n    /**\n     * @private\n     * @type {module:echarts/model/Global}\n     */\n\n    this._ecModel = ecModel;\n    /**\n     * @private\n     * @type {module:echarts/ExtensionAPI}\n     */\n\n    this._api = api;\n    /**\n     * Should be cleaned when render.\n     * @private\n     * @type {Array.<Array.<Object>>}\n     */\n\n    this._lastDataByCoordSys = null;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update();\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  },\n  _initGlobalListener: function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    globalListener.register('itemTooltip', this._api, bind(function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  },\n  _keepShow: function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api; // Try to keep the tooltip show when refreshing\n\n    if (this._lastX != null && this._lastY != null // When user is willing to control tooltip totally using API,\n    // self.manuallyShowTip({x, y}) might cause tooltip hide,\n    // which is not expected.\n    && tooltipModel.get('triggerOn') !== 'none') {\n      var self = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        // Show tip next tick after other charts are rendered\n        // In case highlight action has wrong result\n        // FIXME\n        self.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self._lastX,\n          y: self._lastY\n        });\n      });\n    }\n  },\n\n  /**\n   * Show tip manually by\n   * dispatchAction({\n   *     type: 'showTip',\n   *     x: 10,\n   *     y: 10\n   * });\n   * Or\n   * dispatchAction({\n   *      type: 'showTip',\n   *      seriesIndex: 0,\n   *      dataIndex or dataIndexInside or name\n   * });\n   *\n   *  TODO Batch\n   */\n  manuallyShowTip: function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env.node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction(payload, api); // Reset ticket\n\n    this._ticket = ''; // When triggered from axisPointer.\n\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.position = [payload.x, payload.y];\n      el.update();\n      el.tooltip = payload.tooltip; // Manually show tooltip while view is not using zrender elements.\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        event: {},\n        dataByCoordSys: payload.dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries(payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el,\n          event: {}\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      // FIXME\n      // should wrap dispatchAction like `axisPointer/globalListener` ?\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target,\n        event: {}\n      }, dispatchAction);\n    }\n  },\n  manuallyHideTip: function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction(payload, api));\n    }\n  },\n  // Be compatible with previous design, that is, when tooltip.type is 'axis' and\n  // dispatchAction 'showTip' with seriesIndex and dataIndex will trigger axis pointer\n  // and tooltip.\n  _manuallyAxisShowTip: function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  },\n  _tryShow: function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    } // Save mouse x, mouse y. So we can try to keep showing the tip if chart is refreshed\n\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } // Always show item tooltip if mouse is on the element with dataIndex\n    else if (el && el.dataIndex != null) {\n        this._lastDataByCoordSys = null;\n\n        this._showSeriesItemTooltip(e, el, dispatchAction);\n      } // Tooltip provided directly. Like legend.\n      else if (el && el.tooltip) {\n          this._lastDataByCoordSys = null;\n\n          this._showComponentItemTooltip(e, el, dispatchAction);\n        } else {\n          this._lastDataByCoordSys = null;\n\n          this._hide(dispatchAction);\n        }\n  },\n  _showOrMove: function (tooltipModel, cb) {\n    // showDelay is used in this case: tooltip.enterable is set\n    // as true. User intent to move mouse into tooltip and click\n    // something. `showDelay` makes it easyer to enter the content\n    // but tooltip do not move immediately.\n    var delay = tooltipModel.get('showDelay');\n    cb = zrUtil.bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  },\n  _showAxisTooltip: function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleDefaultHTML = [];\n    var singleParamsList = [];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    each(dataByCoordSys, function (itemCoordSys) {\n      // var coordParamList = [];\n      // var coordDefaultHTML = [];\n      // var coordTooltipModel = buildTooltipModel([\n      //     e.tooltipOption,\n      //     itemCoordSys.tooltipOption,\n      //     ecModel.getComponent(itemCoordSys.coordSysMainType, itemCoordSys.coordSysIndex),\n      //     globalTooltipModel\n      // ]);\n      // var displayMode = coordTooltipModel.get('displayMode');\n      // var paramsList = displayMode === 'single' ? singleParamsList : [];\n      each(itemCoordSys.dataByAxis, function (item) {\n        var axisModel = ecModel.getComponent(item.axisDim + 'Axis', item.axisIndex);\n        var axisValue = item.value;\n        var seriesDefaultHTML = [];\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var valueLabel = axisPointerViewHelper.getValueLabel(axisValue, axisModel.axis, ecModel, item.seriesDataIndices, item.valueLabelOpt);\n        zrUtil.each(item.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var dataParams = series && series.getDataParams(dataIndex);\n          dataParams.axisDim = item.axisDim;\n          dataParams.axisIndex = item.axisIndex;\n          dataParams.axisType = item.axisType;\n          dataParams.axisId = item.axisId;\n          dataParams.axisValue = axisHelper.getAxisRawValue(axisModel.axis, axisValue);\n          dataParams.axisValueLabel = valueLabel;\n\n          if (dataParams) {\n            singleParamsList.push(dataParams);\n            seriesDefaultHTML.push(series.formatTooltip(dataIndex, true));\n          }\n        }); // Default tooltip content\n        // FIXME\n        // (1) shold be the first data which has name?\n        // (2) themeRiver, firstDataIndex is array, and first line is unnecessary.\n\n        var firstLine = valueLabel;\n        singleDefaultHTML.push((firstLine ? formatUtil.encodeHTML(firstLine) + '<br />' : '') + seriesDefaultHTML.join('<br />'));\n      });\n    }, this); // In most case, the second axis is shown upper than the first one.\n\n    singleDefaultHTML.reverse();\n    singleDefaultHTML = singleDefaultHTML.join('<br /><br />');\n    var positionExpr = e.position;\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, singleParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, singleDefaultHTML, singleParamsList, Math.random(), point[0], point[1], positionExpr);\n      }\n    }); // Do not trigger events here, because this branch only be entered\n    // from dispatchAction.\n\n  },\n  _showSeriesItemTooltip: function (e, el, dispatchAction) {\n    var ecModel = this._ecModel; // Use dataModel in element if possible\n    // Used when mouseover on a element like markPoint or edge\n    // In which case, the data is not main data in series.\n\n    var seriesIndex = el.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex); // For example, graph link.\n\n    var dataModel = el.dataModel || seriesModel;\n    var dataIndex = el.dataIndex;\n    var dataType = el.dataType;\n    var data = dataModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var defaultHtml = dataModel.formatTooltip(dataIndex, false, dataType);\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, defaultHtml, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target);\n    }); // FIXME\n    // duplicated showtip if manuallyShowTip is called from dispatchAction.\n\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  },\n  _showComponentItemTooltip: function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (typeof tooltipOpt === 'string') {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        // Fixed formatter\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model(tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random(); // Do not check whether `trigger` is 'none' here, because `trigger`\n    // only works on cooridinate system. In fact, we have not found case\n    // that requires setting `trigger` nothing on component yet.\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el);\n    }); // If not dispatch showTip, tip may be hide triggered by axis.\n\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  },\n  _showTooltipContent: function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el) {\n    // Reset ticket\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    if (formatter && typeof formatter === 'string') {\n      html = formatUtil.formatTpl(formatter, params, true);\n    } else if (typeof formatter === 'function') {\n      var callback = bind(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html);\n    tooltipContent.show(tooltipModel);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  },\n\n  /**\n   * @param  {string|Function|Array.<number>|Object} positionExpr\n   * @param  {number} x Mouse x\n   * @param  {number} y Mouse y\n   * @param  {boolean} confine Whether confine tooltip content in view rect.\n   * @param  {Object|<Array.<Object>} params\n   * @param  {module:zrender/Element} el target element\n   * @param  {module:echarts/ExtensionAPI} api\n   * @return {Array.<number>}\n   */\n  _updatePosition: function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (typeof positionExpr === 'function') {\n      // Callback of position can be an array or a string specify the position\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (zrUtil.isArray(positionExpr)) {\n      x = parsePercent(positionExpr[0], viewWidth);\n      y = parsePercent(positionExpr[1], viewHeight);\n    } else if (zrUtil.isObject(positionExpr)) {\n      positionExpr.width = contentSize[0];\n      positionExpr.height = contentSize[1];\n      var layoutRect = layoutUtil.getLayoutRect(positionExpr, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null; // When positionExpr is left/top/right/bottom,\n      // align and verticalAlign will not work.\n\n      vAlign = null;\n    } // Specify tooltip position by string 'top' 'bottom' 'left' 'right' around graphic element\n    else if (typeof positionExpr === 'string' && el) {\n        var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n        x = pos[0];\n        y = pos[1];\n      } else {\n        var pos = refixTooltipPosition(x, y, content.el, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n        x = pos[0];\n        y = pos[1];\n      }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (tooltipModel.get('confine')) {\n      var pos = confineTooltipPosition(x, y, content.el, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  },\n  // FIXME\n  // Should we remove this but leave this to user?\n  _updateContentNotChangedOnAxis: function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || {};\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged &= lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged &= lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged &= lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  },\n  _hide: function (dispatchAction) {\n    // Do not directly hideLater here, because this behavior may be prevented\n    // in dispatchAction when showTip is dispatched.\n    // FIXME\n    // duplicated hideTip if manuallyHideTip is called from dispatchAction.\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  },\n  dispose: function (ecModel, api) {\n    if (env.node || env.wxa) {\n      return;\n    }\n\n    this._tooltipContent.hide();\n\n    globalListener.unregister('itemTooltip', api);\n  }\n});\n/**\n * @param {Array.<Object|module:echarts/model/Model>} modelCascade\n * From top to bottom. (the last one should be globalTooltipModel);\n */\n\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (Model.isInstance(tooltipOpt)) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      } // In each data item tooltip can be simply write:\n      // {\n      //  value: 10,\n      //  tooltip: 'Something you need to know'\n      // }\n\n\n      if (typeof tooltipOpt === 'string') {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model(tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction(payload, api) {\n  return payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, el, viewWidth, viewHeight, gapH, gapV) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, el, viewWidth, viewHeight) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction getOuterSize(el) {\n  var width = el.clientWidth;\n  var height = el.clientHeight; // Consider browser compatibility.\n  // IE8 does not support getComputedStyle.\n\n  if (document.defaultView && document.defaultView.getComputedStyle) {\n    var stl = document.defaultView.getComputedStyle(el);\n\n    if (stl) {\n      width += parseInt(stl.paddingLeft, 10) + parseInt(stl.paddingRight, 10) + parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n      height += parseInt(stl.paddingTop, 10) + parseInt(stl.paddingBottom, 10) + parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n    }\n  }\n\n  return {\n    width: width,\n    height: height\n  };\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\nmodule.exports = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script"}